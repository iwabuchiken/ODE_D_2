<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>console.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a href="http://www.alsprogrammingresource.com"><img src="../../../../images/als_programming_resource.jpg" alt="Al's Programming Resource Homepage" align="middle" border=0 width=88 height=31 /></a>&nbsp;<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>console.cpp</h1><a href="console_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include &lt;windows.h&gt;</font>
00002 <font class="preprocessor">#include "<a class="code" href="console_8h.html">console.h</a>"</font>
00003 
00004 <font class="keyword">using</font> <font class="keyword">namespace </font>std;
00005 
<a name="l00006"></a><a class="code" href="classConsoleWindow.html#a0">00006</a> <a class="code" href="classConsoleWindow.html#a0">ConsoleWindow::ConsoleWindow</a>()
00007 :   MAX_CONSOLE_ROWS(500),
00008     MAX_CONSOLE_COLUMNS(500)
00009 {
00010     <a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> = INVALID_HANDLE_VALUE;
00011 }
00012 
<a name="l00013"></a><a class="code" href="classConsoleWindow.html#a1">00013</a> <a class="code" href="classConsoleWindow.html#a1">ConsoleWindow::~ConsoleWindow</a>()
00014 {
00015     <font class="keywordflow">if</font> (<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> != INVALID_HANDLE_VALUE)
00016     {
00017         FreeConsole();
00018         fclose(<a class="code" href="classConsoleWindow.html#n2">fp</a>);
00019     }
00020 }
00021 
<a name="l00022"></a><a class="code" href="classConsoleWindow.html#a2">00022</a> <font class="keywordtype">void</font> <a class="code" href="classConsoleWindow.html#a2">ConsoleWindow::Open</a>()
00023 {
00024     <font class="keywordflow">if</font> (<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> == INVALID_HANDLE_VALUE)
00025     {
00026         CONSOLE_SCREEN_BUFFER_INFO coninfo;
00027         <font class="comment">// allocate a console for this app</font>
00028         AllocConsole();
00029         <font class="comment">// set the screen buffer to be big enough to let us scroll text</font>
00030         GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;coninfo);
00031         coninfo.dwSize.Y = <a class="code" href="classConsoleWindow.html#n0">MAX_CONSOLE_ROWS</a>;
00032         SetConsoleScreenBufferSize(GetStdHandle(STD_OUTPUT_HANDLE), coninfo.dwSize);
00033         <font class="comment">// set title</font>
00034         SetConsoleTitle(<font class="stringliteral">"Debug Window"</font>);
00035         <font class="comment">// redirect unbuffered STDOUT to the console</font>
00036         <a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> = GetStdHandle(STD_OUTPUT_HANDLE);
00037         <a class="code" href="classConsoleWindow.html#n4">hConHandle</a> = _open_osfhandle((<font class="keywordtype">long</font>)<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a>, _O_TEXT);
00038         <a class="code" href="classConsoleWindow.html#n2">fp</a> = _fdopen( <a class="code" href="classConsoleWindow.html#n4">hConHandle</a>, <font class="stringliteral">"w"</font> );
00039         *stdout = *<a class="code" href="classConsoleWindow.html#n2">fp</a>;
00040         setvbuf( stdout, NULL, _IONBF, 0 );
00041         <font class="comment">// redirect unbuffered STDIN to the console</font>
00042         <a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> = GetStdHandle(STD_INPUT_HANDLE);
00043         <a class="code" href="classConsoleWindow.html#n4">hConHandle</a> = _open_osfhandle((<font class="keywordtype">long</font>)<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a>, _O_TEXT);
00044         <a class="code" href="classConsoleWindow.html#n2">fp</a> = _fdopen( <a class="code" href="classConsoleWindow.html#n4">hConHandle</a>, <font class="stringliteral">"r"</font> );
00045         *stdin = *<a class="code" href="classConsoleWindow.html#n2">fp</a>;
00046         setvbuf( stdin, NULL, _IONBF, 0 );
00047         <font class="comment">// redirect unbuffered STDERR to the console</font>
00048         <a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> = GetStdHandle(STD_ERROR_HANDLE);
00049         <a class="code" href="classConsoleWindow.html#n4">hConHandle</a> = _open_osfhandle((<font class="keywordtype">long</font>)<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a>, _O_TEXT);
00050         <a class="code" href="classConsoleWindow.html#n2">fp</a> = _fdopen( <a class="code" href="classConsoleWindow.html#n4">hConHandle</a>, <font class="stringliteral">"w"</font> );
00051         *stderr = *<a class="code" href="classConsoleWindow.html#n2">fp</a>;
00052         setvbuf( stderr, NULL, _IONBF, 0 );
00053         <font class="comment">// make cout, wcout, cin, wcin, wcerr, cerr, wclog and clog point to console as well</font>
00054         ios::sync_with_stdio();
00055     }
00056 };
00057 
<a name="l00058"></a><a class="code" href="classConsoleWindow.html#a3">00058</a> <font class="keywordtype">void</font> <a class="code" href="classConsoleWindow.html#a3">ConsoleWindow::Close</a>()
00059 {
00060     <font class="keywordflow">if</font> (<a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> != INVALID_HANDLE_VALUE)
00061     {
00062         FreeConsole();
00063         fclose(<a class="code" href="classConsoleWindow.html#n2">fp</a>);
00064         <a class="code" href="classConsoleWindow.html#n3">hStdHandle</a> = INVALID_HANDLE_VALUE;
00065     }
00066 };
00067 
</pre></div><hr><address align="right"><small>Generated on Thu Feb 9 04:21:43 2006 for Basic ODE Example by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
